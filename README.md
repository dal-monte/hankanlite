## このアプリについて

企業でよく使用されている販売管理システムのようなものを、PHPの勉強の集大成として作成したものです。

山浦清透氏が運営する「独学エンジニア」の最終レッスン（Lesson45）「オリジナルレッスンアプリを作ろう」の成果物として、
独学エンジニアのレッスンを通じて得た知識を元に設計しました。

構成としては、
・Lesson44の「PHPでシャッフルランチサービスを作ろう」で作成したPHPのフルスクラッチMVCモデルとDockerfileをベースとして、
・データベースにMYSQL
・画面表示にX社のBootstrap5
・MYSQL等のログイン情報保管に.env
を使用しています。

本アプリ作成の狙いは、
・Webアプリケーションの仕組みの理解
・オブジェクト指向に慣れる
・自走力の獲得
です。


## 環境構築

Dockerが存在するPCのディレクトリに本コードを保存し、
PHPのComposerをDockerファイルに導入し、
下記SQLデータの作成までを行うとブラウザのローカルホストで動作を確認できます。

使用するローカルホストのナンバーは[localhost:50080]です。
既にそのナンバーを使用中の場合は使用できません。


保存したディレクトリ直下で下記コードを入力して環境構築して下さい。

・Docker イメージをビルドする。
```bash
docker-compose build
```

・Composer(PHP)を導入する。
```bash
docker-compose exec app composer install
```

・SQLデータの作成。
```bash
docker-compose exec app php web/sql_data/all_table_set.php
```

## システム内容

以降のシステム操作の流れは、

1.ルートユーザーとしてログインし、新規企業（ユーザー）を登録すると自動で新規登録企業専用の販売管理データベースを作成。

2.続いて、新規登録企業のシステム管理者情報の登録

3.その管理者がシステムにアクセスし、その企業の追加のシステム管理者や販売担当社員、仕入担当社員を登録。

4.担当者がシステム利用。

となります。


SQLデータの作成まで終わらせてからブラウザでローカルホスト[localhost:50080]にアクセスすると
ログイン画面が表示されます。

そこで下記を入力するとルートユーザーとしてシステムにログインできます。

ID  　 　 : 10
パスワード : hight882255

と入力するとルートユーザーとしてログインして、新規ユーザー（企業）とその管理者ID・パスワードを設定できます。

設定後にログイン画面で管理者IDとパスワードを入力すると、そのユーザーのデータベースにアクセスできます。
※管理者IDとパスワードの設定を行わないとそのデータベースにアクセスする事ができません。

作成した管理者IDでログインし直すと、販売管理システムの画面が表示されます。
その画面のメニューバーの「保守」をクリックし、画面遷移後「社員登録・編集」ボタンを押すと、
社員と登録と編集が可能です。
そこで、企業の追加のシステム管理者や販売担当社員、仕入担当社員を登録・編集が可能です。

それぞれの社員の役割ごとに利用できる要素が異なります。
・システム管理者は、販売管理システムの全ての要素を編集できます。（商品管理・販売管理・仕入管理・保守）
・販売事務は、商品販売に関する要素の閲覧と編集ができます。（商品管理・販売管理）
・仕入事務は、商品仕入に関する要素の閲覧と編集ができます。（商品管理・仕入管理）



## GoogleRecaptcha v3の導入

本システムは「.env」にサイトキーとセキュリティーキーを入力することで、ログイン画面にGoogleRecaptcha v3を導入できます。
GoogleRecaptcha v3のキーは下記URLでGoogleアカウントにログインしてキーを取得して下さい。（外部サイトへ移行します）
https://www.google.com/recaptcha/admin
※1　タイプはv3を選択して下さい(v2用のキーは使用できません）
※2　ラベル名はなんでも構いません。
※3　ドメインには「localhost」と入力して下さい。

取得したGoogleRecaptcha v3のキーを「.env」ファイルの
"reCaptcha_siteKey"　と
"reCaptcha_secretKey"　の右側のダブルクォーテーション内にそれぞれ入力して下さい。
※ダブルクォーテーションは削除しないでください。

導入に成功するとログイン画面の右下にRecaptchaのロゴが表示されます。
